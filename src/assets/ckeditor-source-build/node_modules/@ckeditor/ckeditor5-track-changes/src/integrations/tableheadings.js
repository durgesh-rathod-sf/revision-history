/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{Plugin as _0x5699c7}from'ckeditor5/src/core';import _0x2eee6b from'@ckeditor/ckeditor5-table/src/tablewalker';import ht from'./table';import{getColumnIndexes as _0x1c0bdc,getRowIndexes as _0x10184d,getSelectionAffectedTableCells as _0x259dae}from'@ckeditor/ckeditor5-table/src/utils/selection';export default class ft extends _0x5699c7{static get['requires'](){return[ht];}['afterInit'](){const _0x3a72f4=this['editor'];if(!_0x3a72f4['plugins']['has']('TableEditing'))return;const {t:t}=_0x3a72f4['locale'],_0x311a22=_0x3a72f4['plugins']['get']('TrackChangesEditing'),_0x45c099=_0x3a72f4['plugins']['get']('TableUtils'),_0x48a0e8=_0x3a72f4['plugins']['get'](ht);function _0xcbdea2({showActiveMarker:_0x346fb7=!0x0,setDataAttribute:_0x5005ef=!0x0}={}){return(_0x4cb81a,_0x57f4b5,_0xbec72d)=>{const {type:_0x54af23,id:_0x4faf40}=_0x311a22['_splitMarkerName'](_0x57f4b5['markerName']),_0x306a73=_0x311a22['getSuggestion'](_0x4faf40);if(!_0x306a73['data']||'setTableColumnHeader'!=_0x306a73['data']['commandName'])return;if(_0x57f4b5['item'])return void _0x4cb81a['stop']();if(!_0xbec72d['consumable']['consume'](_0x57f4b5['markerRange'],_0x4cb81a['name']))return;const _0x357aa5=_0x57f4b5['markerRange']['start']['nodeAfter'],_0x1bfe57=_0x57f4b5['markerRange']['end']['nodeBefore'],_0x30f460=_0x357aa5['parent']['parent'],{column:_0x588ec8}=_0x45c099['getCellLocation'](_0x357aa5),{column:_0x59a45f}=_0x45c099['getCellLocation'](_0x1bfe57);for(let _0x17a871=_0x588ec8;_0x17a871<=_0x59a45f;_0x17a871++){const _0x2dd1d9=new _0x2eee6b(_0x30f460,{'column':_0x17a871,'includeAllSlots':!0x1});for(const _0x6f40bb of _0x2dd1d9){const _0x43c12e=_0x6f40bb['cell'],_0x47c292=_0xbec72d['mapper']['toViewElement'](_0x43c12e);_0xbec72d['writer']['addClass']('ck-suggestion-marker-'+_0x54af23,_0x47c292),_0x5005ef&&_0xbec72d['writer']['setAttribute']('data-suggestion',_0x4faf40,_0x47c292),_0xbec72d['mapper']['bindElementToMarker'](_0x47c292,_0x57f4b5['markerName']),_0x346fb7&&(_0x311a22['activeMarkers']['includes'](_0x57f4b5['markerName'])?_0xbec72d['writer']['addClass']('ck-suggestion-marker--active',_0x47c292):_0xbec72d['writer']['removeClass']('ck-suggestion-marker--active',_0x47c292));}}};}_0x311a22['enableCommand']('setTableRowHeader',(_0x3e3b0b,_0x55da7f)=>{const _0x3462b5=_0x259dae(_0x3a72f4['model']['document']['selection']),_0x21ea21=_0x10184d(_0x3462b5),_0x43c2db=_0x3462b5[0x0]['findAncestor']('table'),_0x28a8ce=_0x43c2db['getAttribute']('headingRows')||0x0,_0x222afa=_0x55da7f&&null!==_0x55da7f['forceValue']?_0x55da7f['forceValue']:!_0x3a72f4['commands']['get']('setTableRowHeader')['value'],_0x388d02=_0x222afa?_0x21ea21['last']:_0x21ea21['first'],_0x5518ad=_0x43c2db['getChild'](_0x388d02);let _0x357aec;if(_0x222afa){const _0x1aa5bf=_0x43c2db['getChild'](_0x28a8ce);if(_0x5518ad['index']<_0x1aa5bf['index'])return;_0x357aec=_0x3a72f4['model']['createRange'](_0x3a72f4['model']['createPositionBefore'](_0x1aa5bf['getChild'](0x0)),_0x3a72f4['model']['createPositionAfter'](_0x5518ad['getChild'](_0x5518ad['childCount']-0x1)));}else{const _0x3cd4cd=_0x43c2db['getChild'](_0x28a8ce-0x1);if(!_0x3cd4cd)return;_0x357aec=_0x3a72f4['model']['createRange'](_0x3a72f4['model']['createPositionBefore'](_0x5518ad['getChild'](0x0)),_0x3a72f4['model']['createPositionAfter'](_0x3cd4cd['getChild'](_0x3cd4cd['childCount']-0x1)));}_0x3a72f4['model']['change'](()=>{_0x311a22['markBlockFormat'](_0x357aec,{'commandName':'setTableRowHeader','commandParams':[{'forceValue':_0x222afa}]},[],'setTableRowHeader');});}),_0x311a22['enableCommand']('setTableColumnHeader',(_0x3c6518,_0x5c4fa0)=>{const _0x1f26c=_0x259dae(_0x3a72f4['model']['document']['selection']),_0x531b51=_0x1c0bdc(_0x1f26c),_0x46f751=_0x1f26c[0x0]['findAncestor']('table'),_0x39f336=_0x46f751['getAttribute']('headingColumns')||0x0,_0x5550f7=_0x5c4fa0&&null!==_0x5c4fa0['forceValue']?_0x5c4fa0['forceValue']:!_0x3a72f4['commands']['get']('setTableColumnHeader')['value'];let _0x363428;const _0x26a437=_0x46f751['getChild'](0x0),_0x326d30=_0x5550f7?_0x531b51['last']:_0x531b51['first'],_0x742a87=new _0x2eee6b(_0x46f751,{'startRow':0x0,'column':_0x326d30,'includeAllSlots':!0x1}),_0x51f526=Array['from'](_0x742a87)[0x0]['cell'];if(_0x5550f7){const _0x42440a=_0x26a437['getChild'](_0x39f336);if(_0x51f526['isBefore'](_0x42440a))return;_0x363428=_0x3a72f4['model']['createRange'](_0x3a72f4['model']['createPositionBefore'](_0x42440a),_0x3a72f4['model']['createPositionAfter'](_0x51f526));}else{const _0x42d121=_0x26a437['getChild'](_0x39f336-0x1);if(!_0x42d121)return;_0x363428=_0x3a72f4['model']['createRange'](_0x3a72f4['model']['createPositionBefore'](_0x51f526),_0x3a72f4['model']['createPositionAfter'](_0x42d121));}_0x3a72f4['model']['change'](()=>{_0x311a22['markBlockFormat'](_0x363428,{'commandName':'setTableColumnHeader','commandParams':[{'forceValue':_0x5550f7}]},[],'setTableColumnHeader');});}),_0x3a72f4['editing']['downcastDispatcher']['on']('addMarker:suggestion',_0xcbdea2(),{'priority':'highest'}),_0x3a72f4['data']['downcastDispatcher']['on']('addMarker:suggestion',(_0x4bb52a,_0x2421aa,_0x2d580d)=>{_0x2d580d['options']['showSuggestionHighlights']&&_0xcbdea2({'showActiveMarker':!0x1,'setDataAttribute':!0x1})(_0x4bb52a,_0x2421aa,_0x2d580d);},{'priority':'highest'}),_0x3a72f4['editing']['downcastDispatcher']['on']('removeMarker:suggestion',(_0x581bf9,_0x3bb4f7,_0x2e4c15)=>{const {type:_0x58d05a,id:_0x39ad1c}=_0x311a22['_splitMarkerName'](_0x3bb4f7['markerName']),_0x3a643b=_0x311a22['getSuggestion'](_0x39ad1c);if(!_0x3a643b['data']||'setTableColumnHeader'!=_0x3a643b['data']['commandName'])return;const _0x10f988=_0x2e4c15['mapper']['markerNameToElements'](_0x3bb4f7['markerName']);if(_0x10f988)for(const _0x2cc7a2 of _0x10f988)_0x2e4c15['writer']['removeClass']('ck-suggestion-marker-'+_0x58d05a,_0x2cc7a2),_0x2e4c15['writer']['removeClass']('ck-suggestion-marker--active',_0x2cc7a2),_0x2e4c15['writer']['removeAttribute']('data-suggestion',_0x2cc7a2),_0x2e4c15['mapper']['unbindElementFromMarkerName'](_0x2cc7a2,_0x3bb4f7['markerName']);},{'priority':'highest'}),_0x311a22['_descriptionFactory']['registerDescriptionCallback'](_0x293f8e=>{const {data:_0x4b5995}=_0x293f8e;if(_0x4b5995){if('setTableRowHeader'==_0x4b5995['commandName']){const _0x500816=_0x4b5995['commandParams'][0x0]['forceValue'];return _0x536cde(t(_0x500816?{'string':'header\x20row','id':'FORMAT_HEADER_ROW'}:{'string':'regular\x20row','id':'FORMAT_REGULAR_ROW'}));}if('setTableColumnHeader'==_0x4b5995['commandName']){const _0x55c30c=_0x4b5995['commandParams'][0x0]['forceValue'];return _0x536cde(t(_0x55c30c?{'string':'header\x20column','id':'FORMAT_HEADER_COLUMN'}:{'string':'regular\x20column','id':'FORMAT_REGULAR_COLUMN'}));}}function _0x536cde(_0x4e8edd){return{'type':'format','content':t('*Format:*\x20%0',_0x4e8edd)};}});const _0xe4cab6=_0x48a0e8['_acceptFormatSuggestionCallbackFactory']();_0x311a22['_suggestionFactory']['registerCustomCallback']('formatBlock','setTableRowHeader','accept',_0xe4cab6),_0x311a22['_suggestionFactory']['registerCustomCallback']('formatBlock','setTableColumnHeader','accept',_0xe4cab6);}}