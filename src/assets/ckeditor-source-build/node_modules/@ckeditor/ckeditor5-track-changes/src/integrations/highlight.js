/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{Plugin as _0x4f68ca}from'ckeditor5/src/core';import{getRangesWithAttribute as Rt}from'./utils';export default class K extends _0x4f68ca{['afterInit'](){const _0x3dc23a=this['editor'];if(!_0x3dc23a['plugins']['has']('HighlightEditing'))return;const _0x31b8af=_0x3dc23a['plugins']['get']('TrackChangesEditing');_0x31b8af['enableCommand']('highlight',(_0x235093,_0x3ab185={})=>{const _0x204441=_0x3dc23a['model']['document']['selection'],_0x3b90c7=_0x204441['getAttribute']('highlight');let _0x51e0f7=_0x3ab185['value'],_0x16bed3=[];if(_0x204441['isCollapsed']){const _0xdbcdc5=_0x204441['getFirstPosition']();if(!_0x204441['hasAttribute']('highlight'))return void _0x235093(_0x3ab185);{const _0x1bfe9a=_0x56cb82=>_0x56cb82['item']['getAttribute']('highlight')===_0x3b90c7,_0x44fb99=_0xdbcdc5['getLastMatchingPosition'](_0x1bfe9a,{'direction':'backward'}),_0x4516c5=_0xdbcdc5['getLastMatchingPosition'](_0x1bfe9a);_0x16bed3=[_0x3dc23a['model']['createRange'](_0x44fb99,_0x4516c5)],_0x51e0f7==_0x3b90c7&&(_0x51e0f7=null);}}else for(const _0x48052c of _0x204441['getRanges']())_0x51e0f7?_0x16bed3['push'](_0x48052c):_0x16bed3['push'](...Rt('highlight',_0x48052c,_0x3dc23a['model']));_0x3dc23a['model']['change'](()=>{for(const _0x334899 of _0x16bed3)_0x31b8af['markInlineFormat'](_0x334899,{'commandName':'highlight','commandParams':[{'value':_0x51e0f7}]});});});const {t:t}=_0x3dc23a['locale'];_0x31b8af['_descriptionFactory']['registerDescriptionCallback'](_0x2ee754=>{const {type:_0x33d5fb,data:_0x1d9f57}=_0x2ee754;if('formatInline'==_0x33d5fb&&_0x1d9f57&&'highlight'==_0x1d9f57['commandName']){const _0x36a645=_0x1d9f57['commandParams'][0x0]['value'];if(_0x36a645){const _0xceb38a=_0x3dc23a['config']['get']('highlight.options')['find'](_0x46bbc5=>_0x46bbc5['model']==_0x36a645),_0x5ba7bd=_0x3dc23a['locale']['_t'](_0xceb38a['title'])['toLowerCase']();return{'type':'format','content':t('*Set\x20highlight:*\x20%0',_0x5ba7bd),'color':{'value':_0xceb38a['color'],'title':_0xceb38a['title']}};}return{'type':'format','content':t('*Remove\x20highlight*',t({'string':'highlight','id':'FORMAT_HIGHLIGHT'}))};}});}}